<!DOCTYPE html>
<html>
<head>
  <title>ğŸ”Š Voice Listener</title>
</head>
<body>
  <h2>ğŸ”Š Listening...</h2>
  <p>Status: <span id="status">Connectingâ€¦</span></p>

  <script>
    const status = document.getElementById("status");
    const socket = new WebSocket("wss://voice-stream-server2.onrender.com");
    socket.binaryType = "arraybuffer";

    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    socket.onopen = () => {
      socket.send("listener");
      status.innerText = "Connected âœ…";
    };

    socket.onmessage = (event) => {
      audioContext.decodeAudioData(event.data.slice(0), (buffer) => {
        const source = audioContext.createBufferSource();
        source.buffer = buffer;
        source.connect(audioContext.destination);
        source.start(0);
      });
    };

    socket.onerror = () => {
      status.innerText = "Connection error âŒ";
    };

    socket.onclose = () => {
      status.innerText = "Disconnected ğŸ”Œ";
    };
  </script>
</body>
</html>
