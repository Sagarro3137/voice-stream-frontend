<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Voice Stream Listener</title>
</head>
<body>
  <h2>🔊 Live Audio Listener</h2>
  <p id="status">Connecting to server...</p>

  <script>
    const status = document.getElementById("status");

    const socket = new WebSocket("wss://voice-stream-server2.onrender.com");

    socket.addEventListener("open", () => {
      status.innerText = "✅ Connected to voice stream!";
      socket.send("listener");
    });

    socket.addEventListener("message", (event) => {
      const audioData = event.data;

      const blob = new Blob([audioData], { type: "audio/webm" });

      const audio = new Audio();
      audio.src = URL.createObjectURL(blob);
      audio.play();
    });

    socket.addEventListener("close", () => {
      status.innerText = "❌ Disconnected from server.";
    });

    socket.addEventListener("error", (error) => {
      status.innerText = "❗ Error connecting to server.";
      console.error("WebSocket error:", error);
    });
  </script>
</body>
</html>
