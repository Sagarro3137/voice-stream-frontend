<!DOCTYPE html>
<html>
<head>
  <title>ğŸ™ï¸ Voice Broadcaster</title>
</head>
<body>
  <h2>ğŸ”´ Live Broadcast</h2>
  <button id="startBtn">Start</button>
  <button id="stopBtn">Stop</button>

  <script>
    const ws = new WebSocket("wss://voice-stream-server2.onrender.com");
    let recorder, stream;

    ws.onopen = () => console.log("âœ… Connected to WebSocket");

    document.getElementById("startBtn").onclick = async () => {
      stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      recorder = new MediaRecorder(stream);

      recorder.ondataavailable = e => {
        if (e.data.size > 0 && ws.readyState === 1) {
          ws.send(e.data);
        }
      };

      recorder.start(200); // 200ms chunks
      console.log("ğŸ¤ Recording started");
    };

    document.getElementById("stopBtn").onclick = () => {
      if (recorder) recorder.stop();
      if (stream) stream.getTracks().forEach(track => track.stop());
      console.log("ğŸ›‘ Recording stopped");
    };
  </script>
</body>
</html>
